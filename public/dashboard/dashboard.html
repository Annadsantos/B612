<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exemplo de como Plotar Gráficos</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body onload="obterDados()">
    Gráfico de linhas
    <div>
        <canvas id="linha"></canvas>
        <canvas id="barra"></canvas>

    </div>

    <canvas id="barraMedia"></canvas>

    <canvas id="barraAviador"></canvas>

    <span id="b_usuario"></span>

</body>

</html>
<script>
    b_usuario.innerHTML = sessionStorage.NOME_USUARIO;

    function obterDados() {
    fetch("/dashboard/resultadoPersonagem")
        .then(res => res.json())
        .then(dados => {
            console.log("Dados linha:", dados);
            plotarGraficoLinha(dados);
        });

    // fetch("/dashboard/mediaAcertosErros")
    //     .then(res => res.json())
    //     .then(dados => {
    //         console.log("Média:", dados);
    //         plotarGraficoBarraMedia(dados);
    //     });

    fetch("/dashboard/desenhoAviador")
        .then(res => res.json())
        .then(dados => {
            console.log("Desenho:", dados);
            plotarGraficoBarraAviador(dados);
        });
}

function plotarGraficoBarraMedia(dados) {
    var votos = [];
    var jogadores = [];

    for (var i = 0; i < dados.length; i++) {
        votos.push(dados[i].qtd);
        jogadores.push("Quiz " + dados[i].fkQuiz);
    }

    var ctx = document.getElementById('barraMedia').getContext('2d');

    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: jogadores,
            datasets: [{
                label: 'Votos',
                data: votos,
                backgroundColor: ['rgba(255, 99, 132, 0.2)'],
                borderColor: ['rgba(255, 99, 132, 1)'],
                borderWidth: 1
            }]
        }
    });
}

function plotarGraficoBarraAviador(dados) {
    var votos = [];
    var jogadores = [];

    for (var i = 0; i < dados.length; i++) {
        votos.push(dados[i].qtd);
        jogadores.push("Quiz " + dados[i].fkQuiz);
    }

    var ctx = document.getElementById('barraAviador').getContext('2d');

    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: jogadores,
            datasets: [{
                label: 'Votos',
                data: votos,
                backgroundColor: ['rgba(255, 99, 132, 0.2)'],
                borderColor: ['rgba(255, 99, 132, 1)'],
                borderWidth: 1
            }]
        }
    });
}

</script>